<% include ../header.html %>
<!-- 背景使用百度地图 -->
<script src="/javascripts/echarts.js"></script>
<script src="/javascripts/bmap.min.js"></script>
<script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=q9mOwsKW9KLxXDkPH08wEtv4"></script>

<div class="container-fluid">
    <h3>饼图集合</h3>
    <div class="row">
        <div class="col-md-12">
            <div class="echarts" id="map" style="width: 100%;height: 800px;"></div>
        </div>
    </div>
</div>

<script>
    //初始化echarts实例
    var bmapChart = echarts.init(document.getElementById('map'));
    //散点数据
    var myData = [
        { name: '任城区', value: [116.554466, 35.493731, 290] },
        { name: '汶上县', value: [116.505437, 35.717055, 90] },
        { name: '嘉祥县', value: [116.34861, 35.413257, 190] },
        { name: '金乡县', value: [116.318526, 35.07257, 90] },
        { name: '梁山县', value: [116.102618, 35.808063, 90] },
        { name: '鱼台县', value: [116.657394, 35.017888, 90] },
        { name: '兖州区', value: [116.790119, 35.557953, 160] },
        { name: '邹城区', value: [116.987604, 35.402397, 90] },
        { name: '曲阜区', value: [117.055017, 35.567233, 110] },
        { name: '泗水县', value: [117.257426, 35.6706, 90] },
        { name: '微山县', value: [117.135409, 34.813314, 60] },
    ];
    var option = {
        //echarts配置项
        //添加百度地图
        // bmap: map,
        bmap: {
            center: [116.5938140877, 35.4202305409],//中心点坐标
            zoom: 11,//缩放比例
            roam: true,//开启用户缩放,
            mapStyle: {
                styleJson: [
                    {
                        "featureType": "water",
                        "elementType": "all",
                        "stylers": {
                            "color": "#021019"
                        }
                    },
                    {
                        "featureType": "highway",
                        "elementType": "geometry.fill",
                        "stylers": {
                            "color": "#000000"
                        }
                    },
                    {
                        "featureType": "highway",
                        "elementType": "geometry.stroke",
                        "stylers": {
                            "color": "#147a92"
                        }
                    },
                    {
                        "featureType": "arterial",
                        "elementType": "geometry.fill",
                        "stylers": {
                            "color": "#000000"
                        }
                    },
                    {
                        "featureType": "arterial",
                        "elementType": "geometry.stroke",
                        "stylers": {
                            "color": "#0b3d51"
                        }
                    },
                    {
                        "featureType": "local",
                        "elementType": "geometry",
                        "stylers": {
                            "color": "#000000"
                        }
                    },
                    {
                        "featureType": "land",
                        "elementType": "all",
                        "stylers": {
                            "color": "#08304b"
                        }
                    },
                    {
                        "featureType": "railway",
                        "elementType": "geometry.fill",
                        "stylers": {
                            "color": "#000000"
                        }
                    },
                    {
                        "featureType": "railway",
                        "elementType": "geometry.stroke",
                        "stylers": {
                            "color": "#08304b"
                        }
                    },
                    {
                        "featureType": "subway",
                        "elementType": "geometry",
                        "stylers": {
                            "lightness": -70
                        }
                    },
                    {
                        "featureType": "building",
                        "elementType": "geometry.fill",
                        "stylers": {
                            "color": "#000000"
                        }
                    },
                    {
                        "featureType": "all",
                        "elementType": "labels.text.fill",
                        "stylers": {
                            "color": "#857f7f"
                        }
                    },
                    {
                        "featureType": "all",
                        "elementType": "labels.text.stroke",
                        "stylers": {
                            "color": "#000000"
                        }
                    },
                    {
                        "featureType": "building",
                        "elementType": "geometry",
                        "stylers": {
                            "color": "#022338"
                        }
                    },
                    {
                        "featureType": "green",
                        "elementType": "geometry",
                        "stylers": {
                            "color": "#062032"
                        }
                    },
                    {
                        "featureType": "boundary",
                        "elementType": "all",
                        "stylers": {
                            "color": "#1e1c1c"
                        }
                    },
                    {
                        "featureType": "manmade",
                        "elementType": "geometry",
                        "stylers": {
                            "color": "#022338"
                        }
                    },
                    {
                        "featureType": "poi",
                        "elementType": "all",
                        "stylers": {
                            "visibility": "off"
                        }
                    },
                    {
                        "featureType": "all",
                        "elementType": "labels.icon",
                        "stylers": {
                            "visibility": "off"
                        }
                    },
                    {
                        "featureType": "medical",
                        "elementType": "labels.text.fill",
                        "stylers": {
                            "color": "#2da0c6"
                        }
                    }
                ]
            }

            // mapStyle: {
            //     styleJson: [
            //     {
            //             "featureType": "water",
            //             "elementType": "all",
            //             "stylers": {
            //                 "color": "#044161"
            //             }
            //         },
            //         {
            //             "featureType": "land",
            //             "elementType": "all",
            //             "stylers": {
            //                 "color": "#004981"
            //             }
            //         },
            //         {
            //             "featureType": "boundary",
            //             "elementType": "geometry",
            //             "stylers": {
            //                 "color": "#064f85"
            //             }
            //         },
            //         {
            //             "featureType": "railway",
            //             "elementType": "all",
            //             "stylers": {
            //                 "visibility": "off"
            //             }
            //         },
            //         {
            //             "featureType": "highway",
            //             "elementType": "geometry",
            //             "stylers": {
            //                 "color": "#004981"
            //             }
            //         },
            //         {
            //             "featureType": "highway",
            //             "elementType": "geometry.fill",
            //             "stylers": {
            //                 "color": "#005b96",
            //                 "lightness": 1
            //             }
            //         },
            //         {
            //             "featureType": "highway",
            //             "elementType": "labels",
            //             "stylers": {
            //                 "visibility": "off"
            //             }
            //         },
            //         {
            //             "featureType": "arterial",
            //             "elementType": "geometry",
            //             "stylers": {
            //                 "color": "#004981"
            //             }
            //         },
            //         {
            //             "featureType": "arterial",
            //             "elementType": "geometry.fill",
            //             "stylers": {
            //                 "color": "#00508b"
            //             }
            //         },
            //         {
            //             "featureType": "poi",
            //             "elementType": "all",
            //             "stylers": {
            //                 "visibility": "off"
            //             }
            //         },
            //         {
            //             "featureType": "green",
            //             "elementType": "all",
            //             "stylers": {
            //                 "color": "#056197",
            //                 "visibility": "off"
            //             }
            //         },
            //         {
            //             "featureType": "subway",
            //             "elementType": "all",
            //             "stylers": {
            //                 "visibility": "off"
            //             }
            //         },
            //         {
            //             "featureType": "manmade",
            //             "elementType": "all",
            //             "stylers": {
            //                 "visibility": "off"
            //             }
            //         },
            //         {
            //             "featureType": "local",
            //             "elementType": "all",
            //             "stylers": {
            //                 "visibility": "off"
            //             }
            //         },
            //         {
            //             "featureType": "arterial",
            //             "elementType": "labels",
            //             "stylers": {
            //                 "visibility": "off"
            //             }
            //         },
            //         {
            //             "featureType": "boundary",
            //             "elementType": "geometry.fill",
            //             "stylers": {
            //                 "color": "#029fd4"
            //             }
            //         },
            //         {
            //             "featureType": "building",
            //             "elementType": "all",
            //             "stylers": {
            //                 "color": "#1a5787"
            //             }
            //         },
            //         {
            //             "featureType": "label",
            //             "elementType": "all",
            //             "stylers": {
            //                 "visibility": "off"
            //             }
            //         }
            //     ]
            // }
        },
        visualMap: {
            //视觉映射组件
            type: 'continuous',
            min: 0,
            max: 300,
            calculable: true,
            inRange: {
                color: ['#50a3ba', '#eac736', '#d94e5d']
            },
            textStyle: {
                color: '#fff'
            }
        },
        series: [
            {
                name: '销量',
                type: 'scatter',
                coordinateSystem: 'bmap', //坐标系使用bmap
                data: myData,
                symbolSize: function (val) {
                    return val[2] / 10;
                }
            }
        ]
    };

    if (option && typeof option === "object") {
        bmapChart.setOption(option, true);
    };
    var bmap = bmapChart.getModel().getComponent('bmap').getBMap();//百度地图实例
    bmap.addControl(new BMap.ScaleControl());//比例尺

    var cityName = '济宁市';
    // bmap.centerAndZoom(cityName, 10);                     // 初始化地图,设置中心点坐标和地图级别。
    var point = new BMap.Point(116.9938140877, 35.2502305409);  // 创建点坐标  
    bmap.centerAndZoom(point, 10);                 // 初始化地图，设置中心点坐标和地图级别  
    bmap.addControl(new BMap.OverviewMapControl());              //添加缩略地图控件
    bmap.enableScrollWheelZoom();
    bmap.addControl(new BMap.NavigationControl({ type: BMAP_NAVIGATION_CONTROL_LARGE, anchor: BMAP_ANCHOR_TOP_LEFT, offset: new BMap.Size(40, 250) }));
    var bdary = new BMap.Boundary();
    bdary.get(cityName, function (rs) {       //获取行政区域       
        // bmap.clearOverlays();        //清除地图覆盖物 使用后会清掉小圆点 

        //for循环都删除掉了，只剩下这个
        //网上查了下，东西经南北纬的范围
        var EN_JW = "180, 90;";         //东北角
        var NW_JW = "-180,  90;";       //西北角
        var WS_JW = "-180, -90;";       //西南角
        var SE_JW = "180, -90;";        //东南角
        //4.添加环形遮罩层
        var ply1 = new BMap.Polygon(rs.boundaries[0] + SE_JW + SE_JW + WS_JW + NW_JW + EN_JW + SE_JW, { strokeColor: "none", fillColor: "rgb(246,246,246)", fillOpacity: 1, strokeOpacity: 0.5 }); //建立多边形覆盖物

        bmap.addOverlay(ply1);
        //5. 给目标行政区划添加边框，其实就是给目标行政区划添加一个没有填充物的遮罩层
        var ply = new BMap.Polygon(rs.boundaries[0], { strokeWeight: 2, strokeColor: "#00f", fillColor: "" });
        bmap.addOverlay(ply);
        // bmap.setViewport(ply.getPath());    //调整视野
    });
</script>
<% include ../footer.html %>